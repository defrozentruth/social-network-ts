{"version":3,"sources":["../../server/controllers/news-feed.ts"],"names":["Error","NewsFeedController","newsRepo","userRepo","constructor","this","getNewsFeed","async","id","user","await","getById","friends","console","log","let","result","elem","push","getNewsByAuthorId","sort","a","b","dateA","date","Date","dateB","getTime"],"mappings":"OACQA,KAA+B,KAAnB,yCAICC,mBACGC,SAAkCC,SAAtDC,YAAoBF,EAAkCC,GAAlCE,KAAAH,SAAAA,EAAkCG,KAAAF,SAAAA,CAA2B,CAE1EG,YAAcC,MAAOC,IAExB,IAAMC,EAAOC,MAAML,KAAKF,SAASQ,QAAQH,CAAE,EAErCI,GADNC,QAAQC,IAAIL,CAAI,EACAA,EAAKG,SAErB,GAAI,CAACA,EACD,MAAM,IAAIZ,MAAM,oBAAqBQ,oBAAqB,EAG9DO,IAAIC,EAAiB,GAGrB,IAAK,MAAMC,KAAQL,EACfI,EAAOE,KAAS,GAAGR,MAAML,KAAKH,SAASiB,kBAAkBF,CAAI,CAAE,EAGnE,OAAOD,EAAOI,KAAK,CAACC,EAASC,KACnBC,EAAQF,EAAEG,KAAO,IAAIC,KAAKJ,EAAEG,IAAI,EAAI,KACpCE,EAAQJ,EAAEE,KAAO,IAAIC,KAAKH,EAAEE,IAAI,EAAI,KAE1C,OAAID,GAASG,EACFH,EAAMI,QAAO,EAAKD,EAAMC,QAAO,EAGnC,CACX,CAAC,CACL,C","file":"news-feed.js","sourcesContent":["import UserRepository from \"../repository/user.js\";\r\nimport {Error} from \"../types/error.js\";\r\nimport NewsRepository from \"../repository/news.js\";\r\nimport News from \"../models/news.js\";\r\n\r\nexport default class NewsFeedController {\r\n    constructor(private newsRepo: NewsRepository, private userRepo: UserRepository) {}\r\n\r\n    public getNewsFeed = async (id: number) => {\r\n\r\n        const user = await this.userRepo.getById(id)\r\n        console.log(user)\r\n        const friends = user.friends;\r\n\r\n        if (!friends) {\r\n            throw new Error(404, `User with id ${id} friend not found`);\r\n        }\r\n\r\n        let result: News[] = [];\r\n\r\n\r\n        for (const elem of friends) {\r\n            result.push(...[...await this.newsRepo.getNewsByAuthorId(elem)])\r\n        }\r\n\r\n        return result.sort((a: News, b: News) => {\r\n            const dateA = a.date ? new Date(a.date) : null;\r\n            const dateB = b.date ? new Date(b.date) : null;\r\n\r\n            if (dateA && dateB) {\r\n                return dateA.getTime() - dateB.getTime();\r\n            }\r\n\r\n            return 0;\r\n        });\r\n    }\r\n}"]}